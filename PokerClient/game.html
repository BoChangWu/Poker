<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Poker</title>
    <script src="game.js"></script>
    <link rel="stylesheet" href=" https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="game.css">
</head>
<body>
    <ul class="nav nav-pills">
        <li role="presentation" class="active"><a href="#Play" data-toggle="tab">PLAY</a></li>
        <li role="presentation"><a href="#DATA" data-toggle="tab">DATA</a></li>
    </ul>
    <div class="tab-content">
        <div id="Play" class="tab-pane fade in active">
            <h2 class='title'>Poker</h2>
            <div class="choose" id="chooseUsr">
                <label for="usrName">請輸入名字:</label>
                <input type="text" class="cool" id="usrName" name="usrName">
                <button id="useUsr" onclick="chooseUsr()">送出</button>
            </div>
            <div class="pot">
                <h3 class='htitle'>Host</h3>

                <div class="host">
                    <div class="hcard" id="host1">
                        <img src="img/Back_cut.png" alt="" id='hostCard1' width="100px">
                    </div>
                    <div class="hcard" id="host2">
                        <img src="img/Back_cut.png" alt="" id='hostCard2' width="100px">
                    </div>
                    <div class="hcard" id="host3">
                        <img src="img/Back_cut.png" alt="" id='hostCard3' width="100px">
                    </div>
                    <div class="hcard" id="host4">
                        <img src="img/Back_cut.png" alt="" id='hostCard4' width="100px">
                    </div>
                    <div class="hcard" id="host5">
                        <img src="img/Back_cut.png" alt="" id='hostCard5' width="100px">
                    </div>
                </div>
                <div class="potmoney" id="potmoney">0</div>
                <h3 class='ptitle'>Players</h3>
                <div class="pname">
                    <div class="player" id="player1">
                        <h3 class='pid' id="p1">Hank</h3>
                        <div class='hc' id="hc1">
                            <img src="img/Back_cut.png" alt="" id="c1" width='100px'>
                            <img src="img/Back_cut.png" alt="" id="c6" width='100px'>
                        </div>
                        <div class='money' id='p1money'>
                            5000
                        </div>
                    </div>
                    <div class="player" id="player2">
                        <h3 class='pid' id='p2'>Json</h3>
                        <div class='hc' id="hc2">
                            <img src="img/Back_cut.png" alt="" id="c2" width='100px'>
                            <img src="img/Back_cut.png" alt="" id="c7" width='100px'>
                        </div>
                        <div class='money' id='p2money'>
                            5000
                        </div>
                    </div>
                    <div class="player" id="player3">
                        <h3 class='pid' id='p3'>???</h3>
                        <div class='hc' id="hc3">
                            <img src="img/Back_cut.png" alt="" id="c3" width='100px'>
                            <img src="img/Back_cut.png" alt="" id="c8" width='100px'>
                        </div>
                        <div class='money' id='p3money'>
                            0
                        </div>
                        <div class="urMove" id="urMove">
                            <input class="chips" type="number" value="0" id="chips" min="100" step="100">
                            <button class="usrbtn" id="raise" onclick="raise()">Raise</button>
                            <button class="usrbtn" id="call" onclick="call()">call</button>
                            <button class="usrbtn" id="allIn" onclick="allIn()">All in</button>
                            <button class="usrbtn" id="fold" onclick="fold()">Fold</button>

                        </div>
                    </div>
                    <div class="player" id="player4">
                        <h3 class='pid' id="p4">Lily</h3>
                        <div class='hc' id="hc4">
                            <img src="img/Back_cut.png" alt="" id="c4" width='100px'>
                            <img src="img/Back_cut.png" alt="" id="c9" width='100px'>
                        </div>
                        <div class='money' id='p4money'>
                            5000
                        </div>
                    </div>
                    <div class="player" id="player5">
                        <h3 class='pid' id="p5">Chris</h3>
                        <div class='hc' id="hc5">
                            <img src="img/Back_cut.png" alt="" id="c5" width='100px'>
                            <img src="img/Back_cut.png" alt="" id="c10" width='100px'>
                        </div>
                        <div class='money' id='p5money'>
                            5000
                        </div>
                    </div>
                </div>
                <!-- <div class="cards">
                    <div class="pcards" id="card1"></div>
                    <div class="pcards" id="card6"></div>
                    <div class="pcards" id="card2"></div>
                    <div class="pcards" id="card7"></div>
                    <div class="pcards" id="card3"></div>
                    <div class="pcards" id="card8"></div>
                    <div class="pcards" id="card4"></div>
                    <div class="pcards" id="card9"></div>
                    <div class="pcards" id="card5"></div>
                    <div class="pcards" id="card10"></div>
                </div> -->

            </div>
            <div class="hostact">
                <button id="addPlayer" onclick="addPlayers()">加入玩家</button>
                <button id="gameOn" onclick="licensing()" style="display:none;">發牌</button>
                <button id="turnNRiver" onclick="turnNRiver()" style="display:none;">Turn</button>
                <button id="newGame" onclick="newGame()" style="display:none;">新牌局</button>
                <button id="exit" onclick="exit()">離開</button>
            </div>
        </div>
        <div id="DATA" class="tab-pane fade" style="width: 800px;padding:25px;margin: 0 auto;">
            <ul class="nav nav-pills">
                <li role="presentation"><a href="#Get" data-toggle="tab" style="color:black;">玩家</a></li>
                <!--<li role="presentation"><a href="#Find" data-toggle="tab">會員</a></li>-->
                <li role="presentation"><a href="#Insert" data-toggle="tab" style="color:black;">新增</a></li>
                <li role="presentation"><a href="#Update" data-toggle="tab" style="color:black;">修改</a></li>
                <li role="presentation"><a href="#Delete" data-toggle="tab" style="color:black;">刪除</a></li>
            </ul>
            <div class="tab-content">
                <div id="Get" class="tab-pane fade">
                    <h2>全部玩家</h2>
                    <button onclick="getPlayers()">SHOW</button>
                    <div id="players"></div>
                </div>

                <div id="Insert" class="tab-pane fade">
                    <h2>新增玩家</h2>
                    <div class="container">
                        <div class="form-group">
                            <label for="insertName">Name</label>
                            <input id="insertName">
                        </div>
                        <div class="form-group">
                            <label for="insertRemaining">Money</label>
                            <input id="insertRemaining">
                        </div>
                        <button onclick="insertPlayer()">新增</button>
                    </div>
                </div>

                <div id="Update" class="tab-pane fade">
                    <h2>編輯資料</h2>
                    <div class="container">
                        <div class="form-group">
                            <label for="Update">Name</label>
                            <input id="UpdateName" value="請輸入姓名">
                        </div>
                        <div class="form-group">
                            <label for="UpdateRemaining">Money</label>
                            <input id="UpdateRemaining">
                        </div>
                        <button onclick="getOne()">Check</button>
                        <button onclick="UpdatePlayer()" disabled="disabled" id="edit">修改</button>
                        <div id="checkhere" style="margin:auto;"></div>
                    </div>
                </div>

                <div id="Delete" class="tab-pane fade">
                    <h2>刪除資料</h2>
                    <div class="container">
                        <div class="form-group">
                            <label for="deleteName">Name</label>
                            <input id="deleteName">
                        </div>
                        <button onclick="deletePlayer()">刪除</button>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/js/bootstrap.min.js"></script>
    <script src="PlayService.js"></script>
    <script>
        var uname = '';
        var uremaining = 0;
        var uTBB = 0;
        var uFS = 0;
        var uVPiP = 0;
        var uAgg = 0;
        var uCBet = 0;
        var uBB = 0;

        function getPlayers() {
            $.ajax({
                type: "GET",
                url: "http://localhost:3300/api/players"
            }).done(function (players) {
                //alert(JSON.stringify(players));
                var tb = "";
                var gr = "";
                tb += "<table class='table table-striped table-hover'>";
                tb += "<thead>";
                tb += "<tr>";
                tb += "<td>Name</td>";
                tb += "<td>Remaining</td>";
                //tb += "<td>TBB</td>";
                //tb += "<td>FS</td>";
                //tb += "<td>VPiP</td>";
                //tb += "<td>Agg</td>";
                //tb += "<td>CBet</td>";
                //tb += "<td>BB</td>";
                tb += "<td></td>"
                tb += "</tr>";
                tb += "</thead>";
                tb += "<tbody>";
                tb += "<tr>";
                $.each(players, function (index, player) {
                    tb += "<tr>";
                    tb += "<td>" + player.name + "</td>";
                    tb += "<td>" + player.remaining + "</td>";
                    //tb += "<td>" + player.TBB + "</td>";
                    //tb += "<td>" + player.FS + "</td>";
                    //tb += "<td>" + player.VPiP + "</td>";
                    //tb += "<td>" + player.Agg + "</td>";
                    //tb += "<td>" + player.CBet + "</td>";
                    //tb += "<td>" + player.BB + "</td>";
                    tb += "</tr>";
                })
                tb += "</tbody>";

                //gr += "<table class='table table-striped table-hover'>";
                //gr += "<thead>"
                //gr += "<tr>"
                //tb += "<td>GameNo.</td>";
                //tb += "<td>Pot</td>";
                //tb += "<td>Date</td>";
                //tb += "<td>Preflop</td>";
                //tb += "<td>Flop</td>";
                //tb += "<td>Turn</td>";
                //tb += "<td>River</td>";
                //gr += "</tr>"
                //gr += "</thead>"
                //gr += "<tbody>"
                //gr += "</tbody>"
                //gr += "</table>"
                $('#players').html(tb);
            }).fail(function (err) {
                alert(err.statusText);
            });
        };

        function insertPlayer() {
            var player = {
                name: $('#insertName').val(),
                remaining: $('#insertRemaining').val(),
                TBB: 0,
                FS: 0,
                VPiP: 0,
                Agg: 0,
                CBet: 0,
                BB: 0,
            }
            $.ajax({
                type: "POST",
                url: "http://localhost:3300/api/players",
                data: player
            }).done(function (data) {
                alert("新增成功");
            }).fail(function (err) {
                alert(err.statusText);
            });
        }

        //修改資料只修改金額,其他資料照常,所以先建立get的按鈕,再put按鈕
        function getOne() {
            $.ajax({
                type: "GET",
                url: "http://localhost:3300/api/players/" + $('#UpdateName').val()
            }).done(function (player) {
                //alert(JSON.stringify(player).name);
                var one = player[0]
                var tb = "";
                tb += "<table class='table table-striped table-hover'>";
                tb += "<thead>";
                tb += "<tr>";
                tb += "<td>Name</td>";
                tb += "<td>Remaining</td>";
                //tb += "<td>TBB</td>";
                //tb += "<td>FS</td>";
                //tb += "<td>VPiP</td>";
                //tb += "<td>Agg</td>";
                //tb += "<td>CBet</td>";
                //tb += "<td>BB</td>";
                tb += "</tr>";
                tb += "</thead>";
                tb += "<tbody>";
                tb += "<td>" + one.name + "</td>";
                tb += "<td>" + one.remaining + "</td>";
                //tb += "<td>" + one.TBB + "</td>";
                //tb += "<td>" + one.FS + "</td>";
                //tb += "<td>" + one.VPiP + "</td>";
                //tb += "<td>" + one.Agg + "</td>";
                //tb += "<td>" + one.CBet + "</td>";
                //tb += "<td>" + one.BB + "</td>";
                tb += "</tr>";
                tb += "</tbody>";
                $('#checkhere').html(tb);
                uremaining = one.remaining
            }).fail(function (err) {
                alert(err.statusText);
            });
            $('#edit').prop('disabled', false)
        }


        function UpdatePlayer() {
            var player = {
                name: $('#UpdateName').val(),
                remaining: uremaining += parseInt($('#UpdateRemaining').val()),
                //TBB: uTBB,
                //FS: uFS,
                //VPiP: uVPiP,
                //Agg: uAgg,
                //CBet: uCBet,
                //BB: uBB
            }
            $.ajax({
                type: "PUT",
                url: "http://localhost:3300/api/players",
                data: player
            }).done(function (player) {
                //var who = player[0];
                //who.remaining += $('UpdateRemaining').val();
                //edit(who)
                alert('加值成功')
            }).fail(function (err) {
                alert(err.statusText);
            });
        };


        function deletePlayer() {
            $.ajax({
                type: "DELETE",
                url: "http://localhost:3300/api/players/" + $('#deleteName').val()
            }).done(function (data) {
                alert('刪除成功');
            }).fail(function (err) {
                alert(err.statusText);
            })
        }
    </script>

</body>
</html>